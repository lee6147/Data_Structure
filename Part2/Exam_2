#include <stdio.h>
#include <string.h>
#include <ctype.h>
#include <stdlib.h>

#define MAX_STACK_SIZE 100

// ----- 스택 관련 전역 -----
// 연산자(char)를 저장하지만, 기존 코드 유지를 위해 int로 둡니다.
typedef int element;
element stack[MAX_STACK_SIZE];
int top;

// ----- 스택 관련 함수들 -----
void init_stack()
{
    top = -1; // 스택 초기화
}
int is_empty()
{
    return (top == -1);
}
int is_full()
{
    return (top == MAX_STACK_SIZE - 1);
}
int size()
{
    return top + 1;
}
void push(element item)
{
    if (!is_full())
        stack[++top] = item;
}
element pop()
{
    if (is_empty())
        return -1; // 언더플로우 방지
    return stack[top--];
}
element peek()
{
    if (is_empty())
        return -1;
    return stack[top];
}

// ----- 연산자 우선순위 함수 -----
int prec(char op)
{
    // 오류 1: switch-case 문법 오류 수정
    switch (op)
    {
    case '(': return 0;
    case '+':
    case '-':
        return 1;
    case '*':
    case '/':
        return 2;
    }

    return -1;
}

// ----- 중위 -> 후위 변환 함수 -----
// 입력: infix_expr (중위 표기 수식)
// 출력: postfix_expr (후위 표기 수식)
void infix_to_postfix(char infix_expr[], char postfix_expr[])
{
    char curr_char, stack_top_op;
    int out_pos = 0;
    int len = strlen(infix_expr);
    
    //init_stack(); 

    for (int i = 0; i < len; i++) {
        // 오류 5: 변수명 오타 수정
        curr_char = infix_expr[i];

        if (isspace(curr_char))
            continue; //공백 무시

        switch (curr_char) {
        // 여는 괄호는 스택에 push
        case '(':
            push(curr_char);
            break;

        // 연산자 처리         
        case '+':
        case '-':
        case '*':
        case '/':
            while (!is_empty() && prec(curr_char) <= prec(peek())) {
                postfix_expr[out_pos++] = pop();
                postfix_expr[out_pos++] = ' ';
            }
            //현재 연산자 스택에 push 
            push(curr_char);
            break;
            
            //닫는 괄호 처리 
        case ')':
        //스택에서 여는 괄호 '('가 나올때까지 모든 연산자를 pop하여 후위 표기식에 추가
            stack_top_op = pop();
            while (! is_empty() && stack_top_op != '(') {
                postfix_expr[out_pos++] = stack_top_op;
                postfix_expr[out_pos++] = ' ';
                stack_top_op = pop();
            }
            break;
            //피연산자(숫자) 처리
        default: 
                while (i < len && isdigit(infix_expr[i])) {
                    postfix_expr[out_pos++] = infix_expr[i++];
                }
                postfix_expr[out_pos++] = ' ';
                i--; 
                break;
            }
        }
    
    
    // 루프 종료 후 스택에 남은 연산자 모두 pop
    while (!is_empty()) {
        postfix_expr[out_pos++] = pop();
        postfix_expr[out_pos++] = ' ';
    }
    
    // 마지막 공백을 제거하고 문자열의 끝(NULL)을 표시
    postfix_expr[out_pos] = '\0';
}

// ----- 메인 함수 -----
// 표준 입력에서 중위식을 받아 후위식으로 변환 후 출력
int main()
{
    int i = 0;
    char input_char = 0;
    char infix_expr[1000] = {0};
    char postfix_expr[1000] = {0};

    // 표준 입력으로 중위 표기식 읽기 (개행 전까지)
    while ((input_char = getchar()) != '\n' && input_char != EOF)
        infix_expr[i++] = input_char;
    infix_expr[i] = '\0';
    
    // 변환 수행
    infix_to_postfix(infix_expr, postfix_expr);

    // 결과 출력
    printf("%s\n", postfix_expr);

    return 0;
}
